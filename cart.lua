-- title:  game title
-- author: game developer
-- desc:   short description
-- script: lua

----------------------------------------------------------------------------------------------------------------------------------------
--CODE FROM HERE------------------------------------------------------------------------------------------------------------------------
t = 0
UIENABLED = 1


--Sky color offset----------------------------------------

middayOffset = {-0x43, -0x5A, -0x0D}
sunsetOffset = {0xCF, -0x40, -0xBA}
currDayStage = -8

paletteTiles = {
    {0x00, 0x00, 0x00},
    {0x00, 0x00, 0x00},
    {0x00, 0x00, 0x00},
    {0x00, 0x00, 0x00},
    {0x00, 0x00, 0x00},
    {0x00, 0x00, 0x00},
    {0x00, 0x00, 0x00},
    {0x00, 0x00, 0x00},
    {0x00, 0x00, 0x00},
    {0x00, 0x00, 0x00},
    {0x00, 0x00, 0x00},
    {0x00, 0x00, 0x00},
    {0x00, 0x00, 0x00},
    {0x00, 0x00, 0x00},
    {0x00, 0x00, 0x00},
    {0x00, 0x00, 0x00},
}

paletteSprites = {
    {0x04,0x18,0x20},
    {0x5D,0x27,0x5D},
    {0xDE,0x3E,0x53},
    {0xEE,0xC6,0xBE},
    {0xFF,0xCD,0x75},
    {0x00,0xD6,0x00},
    {0x38,0xB7,0x64},
    {0x00,0x85,0x28},
    {0x29,0x36,0x6F},
    {0x3B,0x5D,0xC9},
    {0x75,0x3C,0x08},
    {0xD2,0x6D,0x08},
    {0xF4,0xF4,0xF4},
    {0x94,0xB0,0xC2},
    {0x59,0x65,0x89},
    {0x00,0x04,0x04}
}

function savePalette()
    for i = 1, #paletteSprites do 
        paletteTiles[i][0] = peek(0x3fc0 + 3*(i-1))
        paletteTiles[i][1] = peek(0x3fc0 + 3*(i-1) + 1)
        paletteTiles[i][2] = peek(0x3fc0 + 3*(i-1) + 2)
    end
end

function swapPalette(tilePaletteSelected)
    if tilePaletteSelected == 0 then
        tilePaletteSelected = 1

        for i = 1, #paletteSprites do 
            paletteTiles[i][0] = peek(0x3fc0 + 3*(i-1))
            poke(0x3fc0 + 3 * (i-1), paletteSprites[i][0])
            paletteTiles[i][1] = peek(0x3fc0 + 3*(i-1) + 1)
            poke(0x3fc0 + 3 * (i-1) + 1, paletteSprites[i][0] + 1)
            paletteTiles[i][2] = peek(0x3fc0 + 3*(i-1) + 2)
            poke(0x3fc0 + 3 * (i-1) + 2, paletteSprites[i][0] + 2)
        end
    else
        tilePaletteSelected = 0

        for i = 1, #paletteTiles do 
            paletteSprites[i][0] = peek(0x3fc0 + 3*(i-1))
            poke(0x3fc0 + 3 * (i-1), paletteTiles[i][0])
            paletteSprites[i][1] = peek(0x3fc0 + 3*(i-1) + 1)
            poke(0x3fc0 + 3 * (i-1) + 1, paletteTiles[i][0] + 1)
            paletteSprites[i][2] = peek(0x3fc0 + 3*(i-1) + 2)
            poke(0x3fc0 + 3 * (i-1) + 2, paletteTiles[i][0] + 2)
        end
    end
end

function changePallette(targetDayStage)-- -8 is morning (regular colors) 0 midday 7 is sunset
    while currDayStage > targetDayStage and currDayStage > -7 do
        if currDayStage > 0 then --[0:7]
            poke(0x3fc0 + (11 * 3), peek(0x3fc0 + 11*3) - (sunsetOffset[1] / 8))
            poke(0x3fc0 + (11 * 3 + 1), peek(0x3fc0 + 11*3 + 1) - (sunsetOffset[2] / 8))
            poke(0x3fc0 + (11 * 3 + 2), peek(0x3fc0 + 11*3 + 2) - (sunsetOffset[3] / 8))
        elseif currDayStage > -8 then --[-8 : -1]
            poke(0x3fc0 + (11 * 3), peek(0x3fc0 + 11*3) - (middayOffset[1] / 8))
            poke(0x3fc0 + (11 * 3 + 1), peek(0x3fc0 + 11*3 + 1) - (middayOffset[2] / 8))
            poke(0x3fc0 + (11 * 3 + 2), peek(0x3fc0 + 11*3 + 2) - (middayOffset[3] / 8))
        end
        currDayStage = currDayStage - 1
    end

    while currDayStage < targetDayStage and currDayStage < 6 do
        if currDayStage < 0 then --[-8:-1]
            poke(0x3fc0 + (11 * 3), peek(0x3fc0 + 11*3) + (middayOffset[1] / 8))
            poke(0x3fc0 + (11 * 3 + 1), peek(0x3fc0 + 11*3 + 1) + (middayOffset[2] / 8))
            poke(0x3fc0 + (11 * 3 + 2), peek(0x3fc0 + 11*3 + 2) + (middayOffset[3] / 8))
        elseif currDayStage < 7 then --[0-7]
            poke(0x3fc0 + (11 * 3), peek(0x3fc0 + 11*3) + (sunsetOffset[1] / 8))
            poke(0x3fc0 + (11 * 3 + 1), peek(0x3fc0 + 11*3 + 1) + (sunsetOffset[2] / 8))
            poke(0x3fc0 + (11 * 3 + 2), peek(0x3fc0 + 11*3 + 2) + (sunsetOffset[3] / 8))
        end
        currDayStage = currDayStage + 1
    end

    targetDayStage = currDayStage
end

targetDayStage = -8
function SkyUpdate()
    if keyp(61) then --7
        targetDayStage = currDayStage + 1
        changePallette(targetDayStage)
    elseif keyp(60) then
        targetDayStage = currDayStage - 1
        changePallette(targetDayStage)
    end    
end

--Menu----------------------------------------

--scene:
	--0 -> Game scene		| (1,level)
	--1 -> Shop				| (0,1)
	--2 -> Victory screen	| (0,2)
	--3 -> Lost screen		| (0,3)
	--4 -> Main Screen		| (0,0)
--running: 0->paused | 1->running
--level: level id
--battle:
	--0 -> Waiting for battle
	--1 -> Won battle
	--2 -> Lost battle
MAX_LEVEL = 4
GameState = {scene = 4, running = 1, level = 0, battle = 0}

function GameState.init()
	resetGameScene()
	actionGameScene(0)
	GameState.scene = 4
	GameState.running = 1
	GameState.level = 0
	GameState.battle = 0
end

function GameState.update()
	if (GameState.scene == 0) then		--game scene
		
		if (keyp(16)) then 	--P for pause
			GameState.running = (GameState.running + 1) % 2
			actionGameScene(GameState.running)
		end
		
		if (GameState.battle == 1 and GameState.level < MAX_LEVEL) then			--won before last level
			resetGameScene()
			actionGameScene(0)
			if(keyp(19)) then		--Press S to go to shop
				GameState.scene = 1
			end
			goToGameSceneIfKey(14)	--Press N to go to next level
		elseif (GameState.battle == 1 and GameState.level == MAX_LEVEL) then 	--won last level
			resetGameScene()
			GameState.scene = 2
		elseif (GameState.battle == 2) then										--lost
			resetGameScene()
			GameState.scene = 3
		end

	elseif (GameState.scene == 1)	then	--shop		
		--Add buy items logic
		shopMenu.enabled = 1
		goToGameSceneIfKey(14) --Press N to go to next level
	elseif (GameState.scene == 4)	then	--main
		if(keyp(48)) then --Press SPACE to start
			actionGameScene(1)
			GameState.scene = 0
		end
	else 									--victory/losing screen
		actionGameScene(0)
		resetGameScene(0)
		if (keyp(19)) then --Press S to restart
			GameState.init()
		end

	end
end

function GameState.draw()
	print(GameState.scene)
	if(GameState.scene == 0) then
		print("Game scene", 60, 100)


		if (GameState.level == 0) then
			--map(136, 0, 136, 240, )
			print("Level 0", 60, 60)
		elseif (GameState.level == 1) then
			print("Level 1", 60, 60)
		elseif (GameState.level == 2) then
			print("Level 2", 60, 60)
		elseif (GameState.level == 3) then
			print("Level 3", 60, 60)
		elseif (GameState.level == 4) then
			print("Level 4", 60, 60)
		end

		pressSpaceUI()

		if (GameState.battle == 1) then
			wonDuel()
		elseif(GameState.running == 0) then
			pauseMenu()
		end


	elseif (GameState.scene == 1) then
		print("Shop", 60, 100)
	elseif (GameState.scene == 2) then
		print("Victory", 60, 80)
		print("Press S to restart", 60, 100)
	elseif (GameState.scene == 3) then
		print("Lost", 60, 80)
		print("Press S to restart", 60, 100)
	elseif (GameState.scene == 4) then
		rect(0, 0, 240, 136, 2) --menu background -- brown?
		--rectb(60, 34, 120, 68, 4) --menu border --white
		local stringMainMenu = "NAME OF THE GAME"
		local width = print(stringMainMenu, 0, -6)
		print(stringMainMenu, (240-width*2)//2, (136-6)//2 - 50, 1, false, 2)
		stringStart = "Press btn to start!"
		local widthStart = print(stringStart, 0, -6)
		print(stringStart, (240-widthStart)//2, (136-6)//2, 1, false, 1)
	end    
end

function goToGameSceneIfKey(key)
	if(keyp(key)) then
		GameState.battle = 0
		GameState.scene = 0
		GameState.level = GameState.level + 1
		shopMenu.enabled = 0
		actionGameScene(1)
	end
end

active = 0
function pressSpaceUI()
    y = 120-50
    x = 68-10
    l = 10
    w = 50

    text = "SPACE"

    if t%16 == 0 then
        active = (active +1) %2
    end

    if(active == 0) then
        rect(x, y, w, l, 14)
        rect(x, y+l, w, l/2, 15)
        print(text, x+w/2-(#text*3), y+1)
    else
        rect(x, y + l/2, w, l, 14)
        rect(x, y+l + 3*l/8, w, l/4, 15)
        print(text, x+w/2-(#text*3), y+1 + l/2)
    end
end

function pauseMenu()
    rect(60, 34, 120, 68, 3) --menu background -- brown?
    rectb(60, 34, 120, 68, 4) --menu border --white
    print("PAUSED", 102, 50)
    unpauseMess = "Press 'p' to unpause"
    print(unpauseMess, 120 - ((#unpauseMess-2) * 3), 78)
end

function wonDuel()

end

--Duel mechanics------------------------------------------------------
--Player----------------------------------------
opponents = { --may need overwritten visual options
    {"Old McDuff", 30},
    {"Senile Ms Johnson", 29},
    {"\"Not so old\" Jack", 27},
    {"Crooked John", 25},
    {"Doc Richard", 23},
    {"\"Young\" Galen Young", 21},
    {"\"Fastest gun in the west\"", 19},
    {"The silver rider", 17}
}

--fireState: 0 (hasn't fired) / 1 (fired before time) / 2 (fired before opponent) / 3 (fired after opponent) / 4 shot at before shooting
Player = {enabled = 1, reactionSpeed = 0, fireState = 0} 
Semaphore = {enabled = 1, initDelay = 120, wasActivated = 0, currTime = 0, opponentHasFired = 0, opponentTime = 25}

function Player.init()
    Player.reactionSpeed = 0
    Player.fireState = 0
end

function Player.update()
    if Player.enabled == 1 then 
        if keyp(48) and Player.fireState == 0 then --spacebar
            if Semaphore.wasActivated == 1 then
                if Semaphore.opponentHasFired == 1 then
                    Player.fireState = 3 -- fired after opponent
					GameState.battle = 2
                else
                    Player.fireState = 2 -- fired before opponent
					GameState.battle = 1
                end
            else
                Player.fireState = 1 --before time
				GameState.battle = 2
            end
        end
    end
end 

function Player.draw()
    if Player.enabled == 1 then
        print("Fire state:", 0 , 0)
        
        if Player.fireState == 0 then        -- not yet
            print("hasn't shot", 64, 0)
        elseif Player.fireState == 1 then        --early
            print("shot before time!", 64, 0)
        elseif Player.fireState == 2 then   -- on time
            print("shot on time!", 64, 0)
        elseif Player.fireState == 3 then  -- late (state 3)
            print("shot too late...", 64, 0)
        else --shot timeout (state 4)
			GameState.battle = 2 --HOTFIX SPAGHETTI
            print("Not quick enought!", 64, 0)
        end 

        print(Player.reactionSpeed, 164, 0)

        print(targetDayStage, 164, 64) --for sky debug --to remove
    end
end

--Semaphore----------------------------------------

function Semaphore.init()
    Semaphore.initDelay = math.random(60, 180)
    Semaphore.wasActivated = 0
    Semaphore.currTime = 0
	Semaphore.opponentHasFired = 0
end

function Semaphore.update()
    if Semaphore.enabled == 1 then --maybe only allow stopping if not in duel?
        if Semaphore.wasActivated == 0 and Semaphore.initDelay < Semaphore.currTime then
            Semaphore.wasActivated = 1
            Semaphore.currTime = 0
            --also change visual queue
        else
            Semaphore.currTime = Semaphore.currTime + 1
        end

        if Semaphore.wasActivated == 1 and Player.fireState == 0 then
            Player.reactionSpeed = Player.reactionSpeed + 1
            if Player.reactionSpeed > Semaphore.opponentTime then
                Semaphore.opponentHasFired = 1
            end
            if(Player.reactionSpeed > Semaphore.opponentTime + 10) then --if player shot timed out --should be around 10
                Player.fireState = 4
            end
        end 
    end
end

function Semaphore.draw()
    if(Semaphore.enabled == 1) then
        --show visual queue
        if Semaphore.wasActivated == 0 then
            print("Don't", 0 , 24)
        else
            print("Fire!", 0, 24)
        end

        print(Semaphore.currTime, 128, 64)
    end
end

function resetGameScene()
	Semaphore.init()	
	Player.init()
end

function actionGameScene(p)
	Semaphore.enabled = p
	Player.enabled = p
end


dollars = 500
shoppingList = { --bought, name, price, sprite?
    --Consumables (?) --add lives?
    {0, "Watermelon", 5, 0464},
    {0, "Broccoli", 5, 0465},
    {0, "Cherries", 5, 0467},
    {0, "Eggplant", 5, 0468},
    {0, "Strawberry", 5, 0469},
    {0, "Wine", 20, 0470},
    {0, "Soda", 10, 0471},
    {0, "Sandwich", 10, 0472},
    {0, "Scotch", 30, 0473},
    --Weapons
    {0, "Duck Head", 50, 0432},
    {0, "Crossbow", 50, 0434},
    {0, "SlingShot", 50, 452},
    {0, "Shiny Revolver", 45, 0448},
    {0, "Marble fade", 45, 0449},
    {0, "Thomson", 45, 0450},
    {0, "Poison Kunai", 45, 0451},
    {0, "'Nade", 75, 0435},
    {0, "Uzi", 75, 436},
    {0, "Ray gun", 150, 0433},
}

shopMenu = {capacity = 4, topmostIndex = 1, selectedIndex = 1, canScrollUp = 0, canScrollDown = 0, enabled = 0} 
--shopMenu
    --capacity: how many are shown at a time
    --selectedIndex: what item is currently selected 

function shopMenu.init()
	topmostIndex = 1
	selectedIndex = 1
	enabled = 0
end

function shopMenu.update()
	if (shopMenu.enabled == 1) then
		if keyp(2) then --b to buy
            if(dollars > shoppingList[ shopMenu.selectedIndex][3] and shoppingList[ shopMenu.selectedIndex][1]==0) then
                dollars = dollars - shoppingList[shopMenu.selectedIndex][3]
                shoppingList[shopMenu.selectedIndex][1] = 1
                --insert item effects here
            end
		elseif keyp(58) then --up scroll
			if(shopMenu.topmostIndex == shopMenu.selectedIndex and shopMenu.topmostIndex > 1) then--scroll up
				shopMenu.topmostIndex = shopMenu.topmostIndex - 1
				shopMenu.selectedIndex = shopMenu.selectedIndex - 1
			elseif shopMenu.selectedIndex > 1 then
				shopMenu.selectedIndex = shopMenu.selectedIndex - 1
			end
		elseif keyp(59) then --down scroll
			if((shopMenu.topmostIndex + shopMenu.capacity) == shopMenu.selectedIndex and  shopMenu.selectedIndex < #shoppingList) then
				shopMenu.topmostIndex = shopMenu.topmostIndex + 1
				shopMenu.selectedIndex = shopMenu.selectedIndex + 1
			elseif shopMenu.selectedIndex < #shoppingList then
				shopMenu.selectedIndex  = shopMenu.selectedIndex + 1;
			end
		end
	end
end

function shopMenu.draw()
	if (shopMenu.enabled == 1) then
		rect(50, 17, 140, 90, 3) --menu background -- brown?
		rectb(50, 17, 140, 90, 4) --menu border --white

		print("SHOP", 120 - #"SHOP" * 3 + 2, 25)
		if(shopMenu.topmostIndex > 1) then --if can be scrolled up
			print("/\\", 120-#"/\\"*3+2, 35)
		end

		for i = 0, shopMenu.capacity do
			if i + shopMenu.topmostIndex <= #shoppingList then
				print(shoppingList[i+shopMenu.topmostIndex][2], 120 - #shoppingList[i+shopMenu.topmostIndex][2] * 3 + 2, 45 + 10* i)
                if shoppingList[i + shopMenu.topmostIndex][4] ~= -1 then
                    spr(shoppingList[i + shopMenu.topmostIndex][4], 64, 44 + 10 * i, 0, 1, 0, 0, 1, 1)
                end

                print(shoppingList[i+shopMenu.topmostIndex][3], 160, 45 + 10* i)
                print("$", 180, 45 + 10* i)

                if(shoppingList[i+shopMenu.topmostIndex][1] == 1) then
                    line(50 + 35, 47 + 10*i, 50 + 140 - 35, 47 + 10 * i, 15)
                end
			end
		end

		print(">", 54, 45 + (shopMenu.selectedIndex - shopMenu.topmostIndex) * 10)

		if(shopMenu.topmostIndex < #shoppingList-shopMenu.capacity) then --if can be scrolled up
			print("\\/", 120-#"\\/"*3+2, 95)
		end

        rect(120 - 30, 136 - 28, 60, 10, 3)
        rectb(120 - 30, 136 - 28, 60, 10, 4)
        print("$", 120-25, 136 -25)
        print(dollars, 120 - 15, 136 - 25)
	end
end

--CODE UNTIL HERE-------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------

Engine = {
	_init = {savePalette, Semaphore.init, Player.init, shopMenu.init, GameState.init}, 
	_update = {SkyUpdate, Semaphore.update, Player.update, GameState.update, shopMenu.update}, 
	_draw = {Semaphore.draw, Player.draw, shopMenu.draw}, 
	_uidraw = {GameState.draw}
}

function Engine:init()
	if self._init == nil then
		return
	end
	for i=1, #self._init do
		self._init[i]()
	end
end

function Engine:update()
	if self._update == nil then
        return
    end
	for i = 1, #self._update do
		self._update[i]() 
    end
end

function Engine:draw()
	cls(11)
    
	--map((Level.LevelNumber%8)*30,  Level.reflected*17 + Level.LevelNumber//8*34)
	if self._draw == nil then
		return
	end
	for i = 1, #self._draw do
		self._draw[i]()
	end
end

function Engine:uidraw()
	if UIENABLED then
		if self._uidraw == nil then
			return
		end
		for i = 1, #self._uidraw do
			self._uidraw[i]()
		end
	end
end

function Engine:onCicleEnd()
	--debug()


	--Atualização de variáveis
	t=t+1
end

function TIC()
	if(t == 0) then
		Engine:init()
	end	
	Engine:update()
	Engine:draw()
	Engine:uidraw()
	Engine:onCicleEnd()
end

-- <TILES>
-- 001:44444444444444444444444a4a4444aa4444a44a4a444444444444444444444a
-- 002:4444444444444444444aaa444a4444444444a4444a44444444aaa4444444444a
-- 003:444aaa44444444a4a44444444a4444444444a4aa4a444444444aa44444a4444a
-- 004:bbbbbbbbbbbbcbbbbcccbbbbbbbbbbbbbbbbbbbbbbbbccbbbbbbbbcbbbbbbbbb
-- 005:bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
-- 006:bbbbbbccbbbbbbbbbcbbbbbbccbbbbbbbbbbbbbbbbbbccbbbbbbcccbbbccccbb
-- </TILES>

-- <SPRITES>
-- 000:000000000000044400004444400044440444444400002222000033330003333f
-- 001:000000004000000044000000444000044444444422200000333000003f300000
-- 002:000000000000044400004444000044440004444400044222004423330442333f
-- 003:000000004000040044000040444444004444400022200000333000003f300000
-- 004:000000000400044400004444000044440004444400042222044233f34423333f
-- 005:000004004000004044004440444444004444400022240000f3f000003f300000
-- 016:00033333000033330200233f0022222200021122002211120011111200111111
-- 017:3330000033300000ff3000002222000022220000222210002222110022221100
-- 018:44033333000033f30000233f0022222200021122002211120201111200111111
-- 019:3330000033300000ff3000002222000022220000222110002222210022221110
-- 020:004333f3000033330200233f0022222200021121012211120011111201111111
-- 021:f3f0000033300000ff3000002222001022222000212210001222211022221111
-- 032:0011111100111121001111210011112100111121001111210003331100033888
-- 033:1222111011111210111112101111121011111330111113301111100089999000
-- 034:0011111100111111004111210001113100011133000141330000881100008848
-- 035:1221111111111111111110111111103331111033311110001111100089999000
-- 036:0111111101111211011112110111121100111211000331110003331100033888
-- 037:12211211111110111f1120331211103322111000112110001111100089999000
-- 048:0003388800008888000088880000888000008880000088800008888000088880
-- 049:8999900089999900899999000009990000099900000999000009990000099999
-- 050:0004888800008888000088880000888000008880000088800008888000088880
-- 051:8999900089999900899999000009990000099900000999000009990000099999
-- 052:0000388800008888000088880000888800088880008888800088888000888888
-- 053:8999900089999000899990000009900000099000000999000009999000099990
-- 064:00000000000008880000888880009999088888880000dddd0000d3330003d33f
-- 065:0000000080000000880000009990000888888888ddd00000333d00003f3d0000
-- 066:000000000000088800008889000089990008988800088ddd0088d3330883d33f
-- 067:0000000080000800990000809888880088888000ddd00000333000003f300000
-- 068:00000000080008880000888900008999000898880008ddd2088d3323882d333f
-- 069:00000800800000809900888098888800888880002dd80000f3f000003f300000
-- 070:00000000000004440000444404004444004444440000aaaa0000a3330003d33f
-- 071:0000000040000000440000004440040044444000aaa00000333000003f300000
-- 072:000000000000044400004444000044440004444400044aaa0044a3330443d33f
-- 073:0000000040000000440004004444440044444000aaa00000333000003f300000
-- 074:00000000000004440000444400004444000444440004aaa2444a3323442d333f
-- 075:00000000400000004400040044444400444440002aa40000f3f000003f300000
-- 080:0003d3330000dddd00000ddf00000ddd000088dd000888dd008888dd0088888d
-- 081:33300000dddd0000ffdd0000dddd0000ddd80000ddd880008dd88800d8d88800
-- 082:8803d3330000ddfd00000ddf00000ddd000088dd000888dd000888dd0088888d
-- 083:33300000ddd00000ffd00000ddd00000ddd80000ddd880008dd88800d8d88880
-- 084:008d33f3000ddddd0000dddf0000dd2200d88ddd000ddddd2088ddd208888888
-- 085:f3f00000ddd00000ffd00000ddd00000ddd800002ddddd0082ddd88022228888
-- 086:0003d3330000dddd00000ddf00000ddd00004444000444440033344400333444
-- 087:33300000dddd0000ffdd0000dddd000044440000444430004144330044444300
-- 088:0003d3330000ddfd00000ddf00000ddd0000444d000444440003444400333444
-- 089:33300000ddd00000ffd00000ddd00000dd440000444440004144430044444330
-- 090:000d33f3000ddddd0000dddf0000dd2220000ddd000d44440233444403334444
-- 091:f3f00000ddd00000ffd00000ddd00000ddd00000444230001444433044444333
-- 096:00888888008888f8008888f8008888f8008888f8001111f80003338800033999
-- 097:8888888088888880888888808888811088888330888883308888800094499000
-- 098:0088888800888888004888880008883800088833000848330000998800009949
-- 099:8888888888888888888880888888803338888033388880008888800094499000
-- 100:0888888808888288088882880888828800888288000338880003338800033999
-- 101:82288288888880888f8820338288803322888000882880008888800044999000
-- 102:0033344400333444003334440033344400333444001114440003334400033aaa
-- 103:44444330441444304444433044444110444443304414433044444000a44aa000
-- 104:003334440033344400333444003334340003313300033133000044440000aaaa
-- 105:44444333441443334444403344444011344440333414400044444000a44aa000
-- 106:0332444403324444032344440333444400334444000114440003334400033aaa
-- 107:444443334f444011424420332244203342244000414440004444400044aaa000
-- 112:0003399900009999000099990000999000009990000089900008888000088880
-- 113:9999900099999900999999000009990000099900000998000008880000088880
-- 114:0004999900009999000099990000999000009990000089900008888000088880
-- 115:9999900099999900999999000009990000099900000999000008880000088880
-- 116:0000399900009999000099990000999000089990008889900088899000888880
-- 117:9999900099999000999990000009900000099000000888000008888000088880
-- 118:0003399900009999000099990000999000009990000089900008888000088880
-- 119:9999900099999900999999000009990000099900000998000008880000088880
-- 120:0004999900009999000099990000999000009990000089900008888000088880
-- 121:9999900099999900999999000009990000099900000999000008880000088880
-- 122:0000399900009999000099990000999000089990008889900088899000888880
-- 123:9999900099999000999990000009900000099000000888000008888000088880
-- 176:aaffa000aaaaa000acfcf000ac444440cc400000cc444440cc00000022000000
-- 177:e000000be6e66eebeeeeee000aa0e000aaaee000aa000000ad000000dd000000
-- 178:0aaaa0aa0e00aa0a00e00ba0000e0aba0000e00a00aa0e0a0aba00ea0ba00000
-- 179:0000000000ffff000f0df000f0077000f0766700007667000076670000077000
-- 180:b44bbbb0deeeeebbeeeeeeb00eede0000aa000000ad000000ad000000ad00000
-- 192:0e00000b8ee88eeeeeeeee000aa0ee00aaaee000aa000000aa00000088000000
-- 193:000000cd00000cdd0000cde00e0cde0000ede000098e00009810e00081000000
-- 194:00000000000d00d0088888880ddddddd08daaa00dd8bab00d800000080000000
-- 195:00000065000006560000656000f6560000ff6000aabff000a0a00000aaa00000
-- 196:00aa000000a0d00000a00d0000a000d000a0000a0aaaaaaaaba00000ba000000
-- 208:00000000c2f2222cc2222f2c522f22255c2222c565cccc567666666777777777
-- 209:0076650007655650765765656566565576767767070760700006500000075000
-- 210:0007600001176110117766111116611111111131111133110111111000111100
-- 211:00007770000707000070070000700220022022c222c202222222022002200000
-- 212:0000600600007667000011600011c17611cd1110111111101111110001111000
-- 213:0022500702c227500c2255702222262022422222222242222422222012221000
-- 214:c111111cc2c2222cc2c2222cc111111c0c1111c000c11c00000cc00000cccc00
-- 215:0000000000dded0002222220022223c00cc3cc30033222200222222000dded00
-- 216:00000a0acc444a4a02cc44440222cc44cc5522cc00cc22220000cc55000000cc
-- 217:000ff000000ee000000cc00000aaaa0000a33a0000c33c0000a33a0000aaaa00
-- 224:00999900999fcf00909444000999999009944990099449900c9009c000200200
-- </SPRITES>

-- <MAP>
-- 000:505050505050505050505050505050505050505050505050505050505050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 001:505050505050505050505050506050505050405050604050505050505050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 002:405050406050504050605050505040405050505050505050506050405050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 003:504050505040505050605040505050505040504050505050405050505050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 004:505050405050506050505050505060505050505050605050405050505040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 005:505050506050504050505050405040505050505040505050505050405050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 006:504050505050505050504050505050605050505050505050504050505050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 007:101020101010201010101020101010101010101020101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 008:102010101020101020101010202010201010201010101010101020101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 009:101010101010101010101010101010101010101020101020201010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 010:101020101020101010102010101010101020201010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 011:101010101010101020101010101010101010102010202010201010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 012:101010101020101010102010102010201010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 013:102010301030101020102020102020102020102020102020301020201020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 014:101010203010102010301010201020101010101020301010301030102010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 015:101020103010202010201010301010103010302010103010201010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 016:203010203010101020101010201020103020101030101010101010103010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- </MAP>

-- <WAVES>
-- 000:00000000ffffffff00000000ffffffff
-- 001:0123456789abcdeffedcba9876543210
-- 002:0123456789abcdef0123456789abcdef
-- </WAVES>

-- <SFX>
-- 000:07c007c007d007f007f007f007c007c007b007900780077007600750173027203710470057006700770087009700a700a700b700d700e700f700f700302000000000
-- 001:f200f200f20042b502f602f702f722e732b68293e251e210f200f200f200f200f200f200f200f200f200f200f200f200f200f200f200f200f200f200369000000000
-- 002:04e004d004d004d004c004b0049004900490049004800480047004600460045004400430042004100400040004000400040004000400040004000400204000000c00
-- 003:f000f000f000f000f000f000f000f000c010901060305030404040504050407040704080409040a050b050c060b070c090e0c0e0d0f0f000f000f000604000000000
-- 004:61e061e061e061e061e071e071c081b08190817091409110a100b100c100e100f100f100f100f100f100f100f100f100f100f100f100f100f100f100604000000000
-- 005:f000f000f01070207050707070a070c070c070907060c040d020e010f000f000f000f000f000f000f000f000f000f000f000f000f000f000f000f000704000000000
-- 006:f300f300f3000300031003300350038003b003d003f003f003f003f003f003e003b00390036003400320f310f300f300f300f300f300f300f300f300105000000000
-- 016:06c006c006d006f006f006f006c006c006b006900680067006600650163026203610460056006600760086009600a600a600b600d600e600f600f600302000000000
-- </SFX>

-- <TRACKS>
-- 000:180000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 001:180301000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- </TRACKS>

-- <PALETTE>
-- 000:0418205d275db13e53eec6beffcd75a7f07038b76425717929366f3b5dc9753c0873eff7f4f4f494b0c2566c86000404
-- </PALETTE>

